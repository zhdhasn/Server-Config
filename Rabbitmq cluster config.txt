Rabbitmq cluster configuration in ubuntu 20.04
vim /etc/hosts          //in all node
10.88.233.75 ubuntu1
10.88.233.199 ubuntu2

Installing rabbitmq:
apt install rabbitmq-server

Start Service:
systemctl start rabbitmq-server
systemctl enable rabbitmq-server

rabbitmq-plugins enable rabbitmq_management
cd /usr/lib/rabbitmq/lib/rabbitmq_server-3.8.2/plugins/

wget https://github.com/rabbitmq/rabbitmq-delayed-message-exchange/releases/download/v3.8.0/rabbitmq_delayed_message_exchange-3.8.0.ez

rabbitmq-plugins enable rabbitmq_delayed_message_exchange
systemctl restart rabbitmq-server
rabbitmq-plugins list

Replace all node .erlang.cookie with master node .erlang.cookie
scp /var/lib/rabbitmq/.erlang.cookie ubuntu@10.88.233.199:/home/ubuntu
mv /home/ubuntu/.erlang.cookie .erlang.cookie
chmod 400 .erlang.cookie
chown rabbitmq:rabbitmq .erlang.cookie

rabbitmqctl cluster_status
rabbitmqctl add_user radmin kona123
rabbitmqctl set_user_tags radmin administrator
rabbitmqctl set_permissions -p / radmin ".*" ".*" ".*"


Adding the Node with cluster:
rabbitmqctl join_cluster rabbit@ubuntu1
rabbitmqctl cluster_status

Optional in Master node:
rabbitmqctl set_policy ha-all ".*" '{"ha-mode":"all"}'
rabbitmqctl set_policy ha-two "^two\."    '{"ha-mode":"exactly","ha-params":2,"ha-sync-mode":"automatic"}'
rabbitmqctl set_policy ha-nodes "^nodes\."    '{"ha-mode":"nodes","ha-params":["rabbit@ip-172-22-78-72", "rabbit@ip-172-22-79-73"]}'
rabbitmqctl list_policies
